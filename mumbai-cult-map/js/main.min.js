_icon_size=[17,17];500>=$(window).width()&&(_icon_size=[13,13]);var pinClr={};pinClr["01"]=L.icon({iconUrl:"assets/icons/pin1.png",iconSize:_icon_size});pinClr["02"]=L.icon({iconUrl:"assets/icons/pin2.png",iconSize:_icon_size});pinClr["03"]=L.icon({iconUrl:"assets/icons/pin3.png",iconSize:_icon_size});pinClr["04"]=L.icon({iconUrl:"assets/icons/pin4.png",iconSize:_icon_size});pinClr["05"]=L.icon({iconUrl:"assets/icons/pin5.png",iconSize:_icon_size});
pinClr["06"]=L.icon({iconUrl:"assets/icons/pin6.png",iconSize:_icon_size});pinClr["07"]=L.icon({iconUrl:"assets/icons/pin7.png",iconSize:_icon_size});pinClr["08"]=L.icon({iconUrl:"assets/icons/pin8.png",iconSize:_icon_size});mylocPin=L.icon({iconUrl:"assets/icons/locmarker.png",iconSize:_icon_size,iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});_zoom_level=11;_map_center=[19.07,73];_tip_zoom=14;__first=!0;_off_center=0;770>=$(window).width()&&(_zoom_level=9.5,_map_center=[19.07,72.95]);
500>=$(window).width()&&(_off_center=6E-4,_zoom_level=10,_map_center=[19.1,72.95]);var mymap=L.map("mapArea",{center:_map_center,zoom:_zoom_level,zoomSnap:.1});markerGroup=L.layerGroup().addTo(mymap);mymap.options.minZoom=9;mymap.options.maxZoom=19;mymap.removeControl(mymap.zoomControl);mymap.setMaxBounds([[20,74],[18,71]]);
L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoicmFuZG9td2Fsa3oiLCJhIjoiY2pjdzFpN3oxMTgyOTJ3bnVhcmptbDltZiJ9.mOQL0Dh0uro2iDlwiumKWw",{id:"mapbox.streets",accessToken:"pk.eyJ1IjoicmFuZG9td2Fsa3oiLCJhIjoiY2pjdzFpN3oxMTgyOTJ3bnVhcmptbDltZiJ9.mOQL0Dh0uro2iDlwiumKWw"}).addTo(mymap);menuOpen=!1;_clrs="#969696 #9F30CE #FF0088 #FF5500 #EA9000 #795548 #12A69D #267BE8".split(" ");_prevCat="00";
500<$(window).width()&&(document.onkeydown=checkKey,$("#search-box").attr("placeholder","Search"));_poi=-1;_sea_len=0;function checkKey(a){a=a||window.event;$("#search-complete").is(":visible")&&($(".search-items").removeClass("search-items-sel"),"38"==a.keyCode&&0<_poi&&_poi--,"40"==a.keyCode&&_poi<_sea_len-1&&_poi++,$(".search-items").eq(_poi).addClass("search-items-sel"),"13"==a.keyCode&&viewInfo($(".search-items").eq(_poi)[0].id.substring(3,6)))}$("#zoom-in").bind("click",function(){mymap.zoomIn()});
$("#zoom-out").bind("click",function(){mymap.zoomOut()});$("#menu-btn").bind("click",toggleMenu);function toggleMenu(){menuOpen?hideMenu():viewMenu()}function viewMenu(){500>=$(window).width()&&($("#map-filter").fadeIn(),$("#menu-pane").css("left","0vw"),menuOpen=!0,hideInfo(),$("#menu-btn").attr("src","assets/icons/back.png"))}
function hideMenu(){500>=$(window).width()&&($("#map-filter").fadeOut(),$("#menu-pane").css("left","-100vw"),menuOpen=!1,$("#menu-btn").attr("src","assets/icons/menu.png"))}$("#map-filter").bind("click",hideMenu);
for(var i=0;i<cat.length;i++){$("#cat-bar").append('<div class="cat-btn" id="cat'+cat[i][1]+'">'+cat[i][0]+"</div>");for(var _items="",j=0;j<cat_ind[cat[i][1]].length;j++)_items+='<div class="cat-item" id="cit'+info[cat_ind[cat[i][1]][j]][3]+'">'+info[cat_ind[cat[i][1]][j]][0]+"</div>";$("#menu-pane").append('<div class="cat-pane"><div class="cat-name" id="cn'+i+'" style="color:'+_clrs[i+1]+'">'+cat[i][0]+'</div><img class="cat-more" id="cm'+i+'" src="assets/icons/down.png"><div class="cat-items-pane" id="ctp'+
i+'">'+_items+"</div></div>")}clrBtn();$(".cat-name,.cat-more").bind("click",function(){_id=this.id[2];"1px"==$("#cm"+_id).css("font-size")?viewItems(_id):hideItems(_id)});function viewItems(a){for(var b=0;b<cat.length;b++)parseInt(a)!=parseInt(cat[b][1])-1&&hideItems(parseInt(cat[b][1]-1));$("#cm"+a).css("font-size","2px");$("#cm"+a).css("transform","rotateZ(180deg)");$("#ctp"+a).slideDown()}
function hideItems(a){$("#cm"+a).css("font-size","1px");$("#cm"+a).css("transform","rotateZ(0deg)");$("#ctp"+a).slideUp()}$(".cat-item").bind("click",function(){$(".cat-item").css("color","#607D8B");viewInfo(this.id.substring(3,6));$("#"+this.id).css("color","#263238")});function clrBtn(){for(var a=0;a<cat.length+1;a++)$(".cat-btn").eq(a).css("color",_clrs[a]),$(".cat-btn").eq(a).css("background-color","white")}$(".cat-btn").bind("click",function(){selCat(this.id.substring(3,5))});
function selCat(a,b){b=void 0===b?!1:b;viewItems(parseInt(a)-1);$("#search-box").val("");clrBtn();$("#cat"+a).css("background-color",_clrs[parseInt(a)]);$("#cat"+a).css("color","white");"00"==a?dropPins(all_pin):dropPins(cat_ind[a]);_prevCat=a;b||hideInfo(!0);homeView()}selCat("00");$("#clear-btn").hide();mymap.on("click",function(a){hideInfo(recc=!1,hmv=!1)});$("#clear-btn").bind("click",function(){$("#search-box").val("");$("#search-complete").hide();homeView()});
function search(a,b){function g(a,b){return-1!=a.toLowerCase().indexOf(b.toLowerCase())?!0:!1}function h(a,b){return a[1]-b[1]}b=void 0===b?!1:b;0<=a.length?$("#clear-btn").show():$("#clear-btn").hide();if(3>a.length)$("#search-complete").hide();else{var d=[],e=[];if(b)e.push(a);else{for(var c=0;c<index.length;c++)if(g(index[c][0],a)){var f=1-a.length/index[c][0].length;d.push([index[c][1],f])}d=d.sort(h);for(c=0;c<d.length;c++)e.push(d[c][0])}if(b)e.push(a);else{for(c=0;c<ind_add.length;c++)g(ind_add[c][0],
a)&&(f=1-a.length/ind_add[c][0].length,d.push([ind_add[c][1],f]));d=d.sort(h);for(c=0;c<d.length;c++)e.push(d[c][0])}nodup=[];$.each(e,function(a,b){-1===$.inArray(b,nodup)&&nodup.push(b)});e=nodup;if(0==e.length)$("#search-complete").empty(),$("#search-complete").append('<div class="search-items"><i>no results</i></div>'),$("#search-complete").show(),_sea_len=0;else{$("#search-complete").empty();for(c=0;c<e.length;c++)$("#search-complete").append('<div class="search-items" id="sit'+info[e[c]][3]+
'">'+info[e[c]][0]+"</div>");$("#search-complete").show();_sea_len=$(".search-items").length}_poi=-1;$(".search-items").bind("click",function(){viewInfo(this.id.substring(3,6))})}}
function dropPins(a){data=[];for(var b=0;b<a.length;b++)data.push(info[a[b]]);pins={};mymap.removeLayer(markerGroup);markerGroup=L.featureGroup().addTo(mymap).on("click",pinInfo);for(b=0;b<data.length;b++)L.popup({autoClose:!1}).setContent(data[b][0]),pins[data[b][3]]=L.marker([data[b][1],data[b][2]],{icon:pinClr[data[b][4]]}).addTo(markerGroup).bindTooltip(data[b][0],{className:"tool-tip"}),pins[data[b][3]].ind=data[b][3];mymap.on("zoomend",function(){if(mymap._zoom>_tip_zoom)for(var a in pins)pins[a].openTooltip();
else for(a in pins)pins[a].closeTooltip()})}function pinInfo(a){i=a.layer.ind;viewInfo(info[i][3])}
function viewInfo(a){clrBtn();hideMenu();_newPins=cat_ind[_prevCat];_newPins.push(a);dropPins(_newPins);$("#search-complete").hide();$("#search-box").val(info[a][0]);$("#info-box").empty();_inf='<img src="assets/icons/cross.png" id="info-close"> <div id="info-name">'+info[a][0]+'</div> <div id="info-add">'+info[a][8]+'</div> <div id="info-phone">';_ph=info[a][6].split("|");_em=info[a][5].split("|");for(k=0;k<_ph.length;k++)_inf+='<a href="tel:'+_ph[k]+'" target="_blank">'+_ph[k]+"</a>&nbsp;&nbsp;&nbsp;";
_inf.slice(0,-50);_inf+='</div><div id="info-email">';for(k=0;k<_em.length;k++)_inf+='<a href="mailto:'+_em[k]+'" target="_blank">'+_em[k]+"</a>&nbsp;&nbsp;&nbsp;";_inf+='</div><div id="info-web"><a href="'+info[a][7]+'" target="_blank">'+info[a][7]+"</div>";$("#info-box").append(_inf);$("#info-box").slideDown();$("#info-close").bind("click",hideInfox);goTo(a)}function debug(){}function hideInfox(){mymap.setZoom(_tip_zoom+.5);$("#info-box").slideUp()}
function hideInfo(a,b){a=void 0===a?!1:a;void 0===b||b?a||selCat(_prevCat):a||selCat(_prevCat,!0);$("#info-box").slideUp()}function goTo(a){crd=info[a];mymap.flyTo([crd[1]-_off_center,crd[2]],18)}function homeView(){mymap.flyTo(_map_center,_zoom_level)}$("#home-view").bind("click",homeView);var gpsView=!1;function getLoc(){gpsView?(mymap.removeLayer(herePin),gpsView=!1):navigator.geolocation?navigator.geolocation.getCurrentPosition(showLoc):alert("Browser does not support")}
function showLoc(a){a=[a.coords.latitude,a.coords.longitude];herePin=L.featureGroup().addTo(mymap);mar=L.marker(a,{icon:mylocPin}).addTo(herePin).bindPopup("You are here").openPopup();mymap.flyTo(a,15);gpsView=!0}$("#curr-loc").bind("click",getLoc);var isAndroid=-1<navigator.userAgent.toLowerCase().indexOf("android");isAndroid&&document.write('<meta name="viewport" content="width=device-width,height='+window.innerHeight+', initial-scale=1.0">');$("#menu-pane").append('<div id="powered">Powered by</div><a href="http://indiaculturelab.org" target="_blank"><img id="logo-power" src="assets/logo.png"></a><div id="desc">Mumbai\u2019s Culture Map shows the diverse cultural landscape of Mumbai. Explore the spaces around you and be part of the cultural scene.</div>');
$("#open-btn").bind("click",function(){$("#content").css("top","0");setTimeout(function(){$(".controls").fadeIn()},1E3);setTimeout(function(){$("#intro").hide()},3E3)});$(".controls").bind("mouseenter",function(){$("#"+this.id).attr("src","assets/icons/"+this.id+"-act.png")});$(".controls").bind("mouseleave",function(){$("#"+this.id).attr("src","assets/icons/"+this.id+".png")});window.onorientationchange=function(){window.location.reload()};dropPins(all_pin);$(".leaflet-control-attribution").hide();